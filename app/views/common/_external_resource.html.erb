<div id="biosharing-api-key" style="display: none;"><%= Rails.application.secrets.biosharing_api_key -%></div>
<% if external_resource.is_tool? or external_resource.is_biosharing? %>
    <% if external_resource.is_tool? -%>
      <% api_uri = external_resource.api_url_of_tool %>
    <% elsif external_resource.is_biosharing? -%>
        <% api_uri = external_resource.api_url_of_biosharing(external_resource.url) %>
    <% end -%>
    <% id = Digest::SHA256.hexdigest external_resource.url %>
<% end %>


<div class="col-md-12 col-sm-12 bounding-box" data-api_uri="<%=api_uri || nil%>" data-id="<%=id || nil%>">
  <%= link_to(external_resource.url, target: :_blank) do %>
      <h4>
        <i class="fa fa-external-link" id="<%=id%>-resource-type-icon"></i>
        <%= external_resource.title %>
        <% if external_resource.is_biosharing? -%>
        <img src="<%= image_url('biosharing-is.svg')-%>" class="pull-right" alt="Link to BioSharing" width="100px"/>
        <% end -%>
        <!--
        <p>API URI: <%= api_uri -%></p>
        <p>URL: <%= external_resource.url -%></p>
        -->
      </h4>
  <% end %>

  <% if api_uri %>
    <span id="<%=id%>-desc"></span>
      <div class="topics external-links" id="<%=id%>-topics">
        <strong>Topics:</strong>
      </div>
      <div id="<%=id%>-external-links" class="btn-group external-links">
      </div>
  <% end %>
</div>

<% if api_uri %>
    <% if api_uri =~ /biosharing/ -%> <!-- TODO: Perhaps a better means of checking this is needed... -->
      <script>
         Biosharing.displayFullTool('<%=api_uri%>', '<%=id%>');
      </script>
    <% else -%>
      <script>
         Biotools.displayFullTool('<%=api_uri%>', '<%=id%>');
      </script>
    <% end -%>
<% end %>